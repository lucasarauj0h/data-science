{"cells":[{"cell_type":"markdown","source":["Toda empresa que tem presença na internet pode estar interessada em extrair insights\n","de comentários de usuários sobre seus produtos ou serviços, sobre concorrentes, sobre o\n","mercado ou sobre suas próprias preferências.\n","\n","Neste projeto teremos em mãos dados de texto simulando comentários de usuários.\n","Dados de texto são dados em formato não estruturado e seria muito difícil usar um Data\n","Warehouse para armazenar os dados e realizar análise. Por essa razão, usaremos um Data Lake,\n","onde os dados serão carregados em seu formato bruto e então faremos o pré-processamento\n","dos dados em tempo de análise para entregar insights aos tomadores de decisão"],"metadata":{"id":"jVqkfZRySc7s"}},{"cell_type":"markdown","source":["Para este projeto foi usado uma massa de dados fictícios simulando posts de\n","comentários de usuários em redes sociais e/ou blogs. Usaremos o site abaixo para gerar a massa\n","de dados:\n","\n","\n","https://www.mockaroo.com/"],"metadata":{"id":"MmqnJBQfcYaB"}},{"cell_type":"code","source":["# !pip install pymongo"],"metadata":{"id":"5xI4UJSFhdG6"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import json\n","import pymongo\n","import numpy as np\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","import warnings\n","warnings.filterwarnings('ignore')"],"metadata":{"id":"v4akOt7WCX_e"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Conectando no Data Lake"],"metadata":{"id":"q07EmUUQiUlZ"}},{"cell_type":"code","source":["client = pymongo.MongoClient('mongodb://localhost:27017')\n","datalake = client.datalake\n","posts = datalake.posts"],"metadata":{"id":"jaAmG3m8CX88"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["client"],"metadata":{"id":"N2zcayo8CX6Q","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1703702979381,"user_tz":180,"elapsed":13,"user":{"displayName":"Lucas de Araujo Souza","userId":"12226262232717353597"}},"outputId":"9ca95aa4-92db-47ff-819a-298331e29cb0"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=True)"]},"metadata":{},"execution_count":63}]},{"cell_type":"code","source":["datalake = client.datalake"],"metadata":{"id":"uMFDTgw0CX30"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["datalake"],"metadata":{"id":"N9B-xDG8CX1i","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1703702979382,"user_tz":180,"elapsed":11,"user":{"displayName":"Lucas de Araujo Souza","userId":"12226262232717353597"}},"outputId":"45e32637-614c-4b95-f91b-ab88b9f72ef7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=True), 'datalake')"]},"metadata":{},"execution_count":65}]},{"cell_type":"code","source":["datalake.posts.drop()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":355},"id":"HEs1pMFfk1Z5","executionInfo":{"status":"error","timestamp":1703703009207,"user_tz":180,"elapsed":29833,"user":{"displayName":"Lucas de Araujo Souza","userId":"12226262232717353597"}},"outputId":"dadac52a-672a-4b48-b790-9ed512f65a35"},"execution_count":null,"outputs":[{"output_type":"error","ename":"ServerSelectionTimeoutError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mServerSelectionTimeoutError\u001b[0m               Traceback (most recent call last)","\u001b[0;32m<ipython-input-66-976e306b7bcb>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mdatalake\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mposts\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdrop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/collection.py\u001b[0m in \u001b[0;36mdrop\u001b[0;34m(self, session, comment, encrypted_fields)\u001b[0m\n\u001b[1;32m   1242\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_concern\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1243\u001b[0m         )\n\u001b[0;32m-> 1244\u001b[0;31m         dbo.drop_collection(\n\u001b[0m\u001b[1;32m   1245\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__name\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msession\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0msession\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcomment\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcomment\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mencrypted_fields\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mencrypted_fields\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1246\u001b[0m         )\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/_csot.py\u001b[0m in \u001b[0;36mcsot_wrapper\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m    105\u001b[0m                 \u001b[0;32mwith\u001b[0m \u001b[0m_TimeoutContext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    106\u001b[0m                     \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 107\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    108\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    109\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mcast\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mF\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcsot_wrapper\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/database.py\u001b[0m in \u001b[0;36mdrop_collection\u001b[0;34m(self, name_or_collection, session, comment, encrypted_fields)\u001b[0m\n\u001b[1;32m   1241\u001b[0m             )\n\u001b[1;32m   1242\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1243\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_drop_helper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msession\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcomment\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1244\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1245\u001b[0m     def validate_collection(\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/database.py\u001b[0m in \u001b[0;36m_drop_helper\u001b[0;34m(self, name, session, comment)\u001b[0m\n\u001b[1;32m   1154\u001b[0m             \u001b[0mcommand\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"comment\"\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcomment\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1155\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1156\u001b[0;31m         \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__client\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_conn_for_writes\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msession\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mconnection\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1157\u001b[0m             return self._command(\n\u001b[1;32m   1158\u001b[0m                 \u001b[0mconnection\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/mongo_client.py\u001b[0m in \u001b[0;36m_conn_for_writes\u001b[0;34m(self, session)\u001b[0m\n\u001b[1;32m   1311\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1312\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_conn_for_writes\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msession\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mOptional\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mClientSession\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0mContextManager\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mConnection\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1313\u001b[0;31m         \u001b[0mserver\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_select_server\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mwritable_server_selector\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msession\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1314\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_checkout\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mserver\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msession\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1315\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/mongo_client.py\u001b[0m in \u001b[0;36m_select_server\u001b[0;34m(self, server_selector, session, address)\u001b[0m\n\u001b[1;32m   1301\u001b[0m                     \u001b[0;32mraise\u001b[0m \u001b[0mAutoReconnect\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"server %s:%s no longer available\"\u001b[0m \u001b[0;34m%\u001b[0m \u001b[0maddress\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# noqa: UP031\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1302\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1303\u001b[0;31m                 \u001b[0mserver\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtopology\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mselect_server\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mserver_selector\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1304\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mserver\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1305\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mPyMongoError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mexc\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/topology.py\u001b[0m in \u001b[0;36mselect_server\u001b[0;34m(self, selector, server_selection_timeout, address)\u001b[0m\n\u001b[1;32m    300\u001b[0m     ) -> Server:\n\u001b[1;32m    301\u001b[0m         \u001b[0;34m\"\"\"Like select_servers, but choose a random server if several match.\"\"\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 302\u001b[0;31m         \u001b[0mserver\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_select_server\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mselector\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mserver_selection_timeout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maddress\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    303\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0m_csot\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_timeout\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    304\u001b[0m             \u001b[0m_csot\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mset_rtt\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mserver\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdescription\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmin_round_trip_time\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/topology.py\u001b[0m in \u001b[0;36m_select_server\u001b[0;34m(self, selector, server_selection_timeout, address)\u001b[0m\n\u001b[1;32m    284\u001b[0m         \u001b[0maddress\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mOptional\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0m_Address\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    285\u001b[0m     ) -> Server:\n\u001b[0;32m--> 286\u001b[0;31m         \u001b[0mservers\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mselect_servers\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mselector\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mserver_selection_timeout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maddress\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    287\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mservers\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    288\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mservers\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/topology.py\u001b[0m in \u001b[0;36mselect_servers\u001b[0;34m(self, selector, server_selection_timeout, address)\u001b[0m\n\u001b[1;32m    235\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    236\u001b[0m         \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_lock\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 237\u001b[0;31m             \u001b[0mserver_descriptions\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_select_servers_loop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mselector\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mserver_timeout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maddress\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    238\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    239\u001b[0m             return [\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pymongo/topology.py\u001b[0m in \u001b[0;36m_select_servers_loop\u001b[0;34m(self, selector, timeout, address)\u001b[0m\n\u001b[1;32m    257\u001b[0m             \u001b[0;31m# No suitable servers.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    258\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m0\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0mnow\u001b[0m \u001b[0;34m>\u001b[0m \u001b[0mend_time\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 259\u001b[0;31m                 raise ServerSelectionTimeoutError(\n\u001b[0m\u001b[1;32m    260\u001b[0m                     \u001b[0;34mf\"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    261\u001b[0m                 )\n","\u001b[0;31mServerSelectionTimeoutError\u001b[0m: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 658c71c11347f0ef173c6181, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"]}]},{"cell_type":"code","source":["posts = datalake['posts']"],"metadata":{"id":"7H9f4DxTCXx8"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Carregando Dados no Data Lake"],"metadata":{"id":"adIw0mwliWye"}},{"cell_type":"code","source":["# Carrega o arquivo json simulando posts de redes sociais (ficticios)\n","with open('dataset.json') as file:\n","    file_data = json.load(file)"],"metadata":{"id":"oYsImsEVCXuX"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["file_data"],"metadata":{"id":"dyTxp6nQCXrE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Insere o conteúdo do arquivo json na coleção chamada posts. Cada item do arquivo será um documento.\n","posts.insert_many(file_data, ordered = False, bypass_document_validation = True)"],"metadata":{"id":"8v5TEDX3CXo0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Retorna 1 item\n","posts.find_one()"],"metadata":{"id":"RR4vuBasCXly"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Extraindo o numero de documentos dos datalake (posts)\n","n ="],"metadata":{"id":"uiZMYHcmCXiM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"jBFVV30yCXem"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"K5prIydQCXa3"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"G_OKXMsmCXWq"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"LECKUjhJCXSa"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"DOfIFGNWCXN7"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"QRPkC7CSCXJN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"6ApbLeR_CXFV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"mkjYeOZECXA8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"L2Qf2CGcCW9X"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Vj0jMyARCW2h"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"_VBJg-Y-CWyW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"83PggZ5yCWvF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"MFML_qUYCWqo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"znit7zH-CWnQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"9FR-nxNZCWim"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"hIIZW1p6CWe4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"2Q1cnwm0CWcQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"8JUb_zgDCWYG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"eJCAw0ESCWUu"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"88609nyBCWRX"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"WN_idfDeCWN-"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"O7i0tXzvCWKy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"xCG9ivgiCWIM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Wz7rCI9rCWDL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"bf84r8TP6rD7"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Q0rCPXyQ6rBJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"HXw4H7Eu6q-w"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"FBvogMIW6q79"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"PH2cL0nM6q5W"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"oscB22Gk6q3D"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"_ZbG7_fI6q0J"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"J_AbJ66H6qxn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"9ZW7LfaX6qu3"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"it-1eeuL6qsb"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"QcUJwmRY6qp2"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"JbgjdjMR6qnS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"nAle8ETo6qkx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"vBIbVdUn6qiR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"1qAxbgRT6qf-"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Ugud4S8_6qdb"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"9BzUVgA66qas"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"xwXqb_UO6qYB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"wwmrlgBG6qVa"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"9OfocTTb6qSo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Iy9Pndk-6qP4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"iFmC68-46qNB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"UWnTSv1Q6qKk"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"1hzLiNR-6qHx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"wJ1-hrLd6qFr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"qUEQdCUT6qDJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"wSvGQEUy6qAe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"t12h5BrS6p-H"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"PMIt_65t6p74"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"t7OBSmB46p5V"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"PeU9aIia6p3H"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"32jU9k0y6p0D"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"frSVW5BW6pxS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"ioE6CuO36pud"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"OPHxt6aI6pr0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"yOjNOLKu6ppR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"xAzmcd5b6pme"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"25K-k6nv6pkA"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"fDC0OsCb6phf"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"3vmrACD-6pe1"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"10U2Aw6e5xKoYtHmkHPBlF2-Sb9O7U9lC","timestamp":1702584008457},{"file_id":"1xs8jPnykQAjjIAqez1ekRXTid4uBcqUP","timestamp":1700354625567},{"file_id":"1oUXlLhkdqr7jrbaQiWGIPBkftRM2LJvn","timestamp":1699820288677},{"file_id":"1I-XwV-MJ84yz3-o6-1i-mTkaR_f_jO0i","timestamp":1699463333443},{"file_id":"1-3ElPxEGPWVy1B3V4oR67VhXC1Wih021","timestamp":1699216457922},{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1699050301659}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}